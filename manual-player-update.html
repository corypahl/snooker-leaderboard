<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Player Update Tool</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .section h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success { background-color: #d4edda; color: #155724; }
        .status.error { background-color: #f8d7da; color: #721c24; }
        .status.info { background-color: #d1ecf1; color: #0c5460; }
        .player-input {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            align-items: center;
        }
        .player-input input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            flex: 1;
        }
        .player-input input[type="number"] {
            width: 80px;
        }
        .player-input button {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
        }
        .player-input button:hover {
            background-color: #c82333;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .add-player-btn {
            background-color: #28a745;
        }
        .add-player-btn:hover {
            background-color: #218838;
        }
        .current-players {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            background-color: #f8f9fa;
        }
        .player-item {
            background-color: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .player-info {
            flex: 1;
        }
        .player-seed {
            font-weight: bold;
            color: #007bff;
            margin-right: 10px;
        }
        .instructions {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Manual Player Update Tool</h1>
        
        <div class="instructions">
            <h3>Instructions:</h3>
            <p>Since WST.tv uses dynamic JavaScript loading, we need to manually input the player data. Here's how to use this tool:</p>
            <ol>
                <li>Go to <a href="https://www.wst.tv/matches/34ca357d-bed6-4501-b8cd-aa94e5f7ff16?tab=1" target="_blank">WST.tv Draw Page</a></li>
                <li>Wait for the page to fully load (the draw should appear)</li>
                <li>Manually add each player using the form below</li>
                <li>Click "Generate Updated players.json" to download the updated file</li>
                <li>Replace your existing <code>data/players.json</code> file with the new one</li>
            </ol>
        </div>
        
        <div class="section">
            <h3>Add Player</h3>
            <div class="player-input">
                <input type="number" id="seedInput" placeholder="Seed" min="1" max="128">
                <input type="text" id="nameInput" placeholder="Player Name">
                <input type="text" id="statusInput" placeholder="Status" value="playing">
                <input type="number" id="pointsInput" placeholder="Points" value="0">
                <button class="add-player-btn" onclick="addPlayer()">Add Player</button>
            </div>
        </div>
        
        <div class="section">
            <h3>Current Players (<span id="playerCount">0</span>)</h3>
            <div class="current-players" id="currentPlayers">
                <p>No players added yet.</p>
            </div>
            <button onclick="clearAllPlayers()">Clear All Players</button>
            <button onclick="sortPlayers()">Sort by Seed</button>
        </div>
        
        <div class="section">
            <h3>Generate File</h3>
            <button onclick="generatePlayersFile()">Generate Updated players.json</button>
            <div id="fileOutput"></div>
        </div>
        
        <div class="section">
            <h3>Quick Add Common Players</h3>
            <p>Click to add some common players from the tournament:</p>
            <button onclick="addCommonPlayers()">Add Common Players</button>
        </div>
    </div>

    <script>
        let players = [];
        
        function addPlayer() {
            const seed = parseInt(document.getElementById('seedInput').value);
            const name = document.getElementById('nameInput').value.trim();
            const status = document.getElementById('statusInput').value.trim() || 'playing';
            const points = parseInt(document.getElementById('pointsInput').value) || 0;
            
            if (!seed || !name) {
                alert('Please enter both seed and name');
                return;
            }
            
            const player = {
                id: normalizePlayerId(name),
                name: name,
                status: status,
                points: points,
                seed: seed
            };
            
            // Check if player already exists
            const existingIndex = players.findIndex(p => p.id === player.id);
            if (existingIndex >= 0) {
                players[existingIndex] = player;
            } else {
                players.push(player);
            }
            
            updatePlayerDisplay();
            clearInputs();
        }
        
        function normalizePlayerId(name) {
            return name.toLowerCase()
                .replace(/[^a-z0-9\s]/g, '')
                .replace(/\s+/g, '_');
        }
        
        function clearInputs() {
            document.getElementById('seedInput').value = '';
            document.getElementById('nameInput').value = '';
            document.getElementById('statusInput').value = 'playing';
            document.getElementById('pointsInput').value = '0';
        }
        
        function removePlayer(index) {
            players.splice(index, 1);
            updatePlayerDisplay();
        }
        
        function clearAllPlayers() {
            players = [];
            updatePlayerDisplay();
        }
        
        function sortPlayers() {
            players.sort((a, b) => a.seed - b.seed);
            updatePlayerDisplay();
        }
        
        function updatePlayerDisplay() {
            const container = document.getElementById('currentPlayers');
            const countSpan = document.getElementById('playerCount');
            
            countSpan.textContent = players.length;
            
            if (players.length === 0) {
                container.innerHTML = '<p>No players added yet.</p>';
                return;
            }
            
            container.innerHTML = players.map((player, index) => `
                <div class="player-item">
                    <div class="player-info">
                        <span class="player-seed">#${player.seed}</span>
                        <strong>${player.name}</strong>
                        <span style="color: #666;">(${player.status}, ${player.points} pts)</span>
                    </div>
                    <button onclick="removePlayer(${index})">Remove</button>
                </div>
            `).join('');
        }
        
        function generatePlayersFile() {
            if (players.length === 0) {
                alert('Please add some players first');
                return;
            }
            
            // Sort players by seed
            const sortedPlayers = [...players].sort((a, b) => a.seed - b.seed);
            
            const playersData = {
                players: sortedPlayers,
                lastUpdated: new Date().toISOString(),
                source: "Manual update from WST.tv",
                totalPlayers: sortedPlayers.length
            };
            
            const jsonContent = JSON.stringify(playersData, null, 2);
            
            // Create download link
            const blob = new Blob([jsonContent], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'players.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            document.getElementById('fileOutput').innerHTML = `
                <div class="status success">
                    <strong>File generated successfully!</strong><br>
                    Players: ${sortedPlayers.length}<br>
                    File: players.json<br>
                    <small>Replace your existing data/players.json file with this new one.</small>
                </div>
            `;
        }
        
        function addCommonPlayers() {
            const commonPlayers = [
                { seed: 1, name: "Judd Trump", status: "playing", points: 0 },
                { seed: 2, name: "Ronnie O'Sullivan", status: "playing", points: 0 },
                { seed: 3, name: "Mark Allen", status: "playing", points: 0 },
                { seed: 4, name: "Mark Selby", status: "playing", points: 0 },
                { seed: 5, name: "Shaun Murphy", status: "playing", points: 0 },
                { seed: 6, name: "Neil Robertson", status: "playing", points: 0 },
                { seed: 7, name: "Kyren Wilson", status: "playing", points: 0 },
                { seed: 8, name: "John Higgins", status: "playing", points: 0 },
                { seed: 9, name: "Barry Hawkins", status: "playing", points: 0 },
                { seed: 10, name: "Stuart Bingham", status: "playing", points: 0 },
                { seed: 11, name: "Jack Lisowski", status: "playing", points: 0 },
                { seed: 12, name: "Luca Brecel", status: "playing", points: 0 },
                { seed: 13, name: "David Gilbert", status: "playing", points: 0 },
                { seed: 14, name: "Tom Ford", status: "playing", points: 0 },
                { seed: 15, name: "Gary Wilson", status: "playing", points: 0 },
                { seed: 16, name: "Robert Milkins", status: "playing", points: 0 },
                { seed: 17, name: "Ryan Day", status: "playing", points: 0 },
                { seed: 18, name: "Joe Perry", status: "playing", points: 0 },
                { seed: 19, name: "Anthony McGill", status: "playing", points: 0 },
                { seed: 20, name: "Hossein Vafaei", status: "playing", points: 0 },
                { seed: 21, name: "Ding Junhui", status: "playing", points: 0 },
                { seed: 22, name: "Ali Carter", status: "playing", points: 0 },
                { seed: 23, name: "Stephen Maguire", status: "playing", points: 0 },
                { seed: 24, name: "Zhou Yuelong", status: "playing", points: 0 },
                { seed: 25, name: "Xiao Guodong", status: "playing", points: 0 },
                { seed: 26, name: "Yan Bingtao", status: "playing", points: 0 },
                { seed: 27, name: "Liang Wenbo", status: "playing", points: 0 },
                { seed: 28, name: "Zhao Xintong", status: "playing", points: 0 },
                { seed: 29, name: "Fan Zhengyi", status: "playing", points: 0 },
                { seed: 30, name: "Lu Ning", status: "playing", points: 0 },
                { seed: 31, name: "Tian Pengfei", status: "playing", points: 0 },
                { seed: 32, name: "Li Hang", status: "playing", points: 0 }
            ];
            
            // Add players that aren't already in the list
            commonPlayers.forEach(player => {
                const existingIndex = players.findIndex(p => p.id === normalizePlayerId(player.name));
                if (existingIndex === -1) {
                    players.push({
                        ...player,
                        id: normalizePlayerId(player.name)
                    });
                }
            });
            
            updatePlayerDisplay();
        }
        
        // Load existing players if available
        async function loadExistingPlayers() {
            try {
                const response = await fetch('data/players.json');
                if (response.ok) {
                    const data = await response.json();
                    if (data.players && Array.isArray(data.players)) {
                        players = data.players;
                        updatePlayerDisplay();
                    }
                }
            } catch (error) {
                console.log('No existing players.json found or error loading it');
            }
        }
        
        // Load existing players on page load
        loadExistingPlayers();
    </script>
</body>
</html> 